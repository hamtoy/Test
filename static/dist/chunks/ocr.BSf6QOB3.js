import{b as l,s as o}from"./utils.NDa8fJII.js";async function u(s="ocr-input"){const a=document.getElementById(s)||document.getElementById("ocr-preview");if(!a){console.error("OCR element not found");return}try{const t=(await l("/api/ocr")).ocr||"";a.tagName==="TEXTAREA"?(a.value=t,t||(a.placeholder="OCR íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”...")):(a.textContent=t||"OCR íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.",t||(a.style.color="#999"))}catch(e){const t=e instanceof Error?e.message:"OCR ë¡œë“œ ì‹¤íŒ¨";a.tagName==="TEXTAREA"?(a.value="",a.placeholder=t):a.textContent=t,o(`OCR ë¡œë“œ ì‹¤íŒ¨: ${t}`,"error")}}async function g(s="ocr-input",a="ocr-save-status"){const e=document.getElementById(s);if(!e){console.error("OCR source not found");return}const t=document.getElementById(a);try{await l("/api/ocr","POST",{text:e.value}),t&&(t.textContent="âœ… ì €ì¥ë¨",t.className="status-text success",setTimeout(()=>t.textContent="",2e3))}catch(r){if(t)t.textContent="âŒ ì €ì¥ ì‹¤íŒ¨",t.className="status-text error";else{const n=r instanceof Error?r.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";o("OCR ì €ì¥ ì‹¤íŒ¨: "+n,"error")}}}async function d(s){const a=new FormData;a.append("file",s);try{const e=await fetch("/api/ocr/image",{method:"POST",body:a});if(!e.ok){const t=await e.json();throw new Error(t.detail||"OCR ì²˜ë¦¬ ì‹¤íŒ¨")}return await e.json()}catch(e){const t=e instanceof Error?e.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";return o(`ì´ë¯¸ì§€ OCR ì‹¤íŒ¨: ${t}`,"error"),null}}function f(s="image-drop-zone",a="ocr-input"){const e=document.getElementById(s),t=document.getElementById(a),r=document.getElementById("image-file-input");!e||!t||(e.addEventListener("dragover",n=>{n.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",async n=>{n.preventDefault(),e.classList.remove("drag-over");const i=n.dataTransfer?.files;i&&i.length>0&&await c(i[0],t,e)}),e.addEventListener("click",()=>{r?.click()}),r?.addEventListener("change",async()=>{r.files&&r.files.length>0&&await c(r.files[0],t,e)}))}async function c(s,a,e){if(!["image/png","image/jpeg","image/gif","image/webp","image/bmp"].includes(s.type)){o("ì§€ì›í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ í˜•ì‹ì…ë‹ˆë‹¤","error");return}const r=e.innerHTML;e.innerHTML=`
        <div class="ocr-loading">
            <div class="spinner"></div>
            <span>ğŸ” Gemini Vision OCR ì²˜ë¦¬ ì¤‘...</span>
        </div>
    `,e.classList.add("processing");try{const n=await d(s);n&&n.ocr&&(a.value=n.ocr,o(`âœ… OCR ì™„ë£Œ! ${n.ocr.length}ì ì¶”ì¶œ`,"success"),n.metadata.topics.length>0&&console.log("ì¶”ì¶œëœ ì£¼ì œ:",n.metadata.topics),n.metadata.has_table_chart&&o("ğŸ“Š í‘œ/ì°¨íŠ¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤","info"))}finally{e.innerHTML=r,e.classList.remove("processing")}}export{f as i,u as l,g as s};
//# sourceMappingURL=ocr.BSf6QOB3.js.map
