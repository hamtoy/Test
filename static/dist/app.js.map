{"version":3,"mappings":"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","names":["copyTimeouts","sleep","ms","resolve","showToast","message","type","toast","ApiError","status","errorData","detail","handleApiError","error","registerGlobalErrorHandlers","event","reason","apiCall","url","method","body","signal","options","response","apiCallWithRetry","params","retries","initialDelayMs","rest","withRetry","copyToClipboard","text","buttonEl","timeout","err","showProgressWithEstimate","mode","estimatedTime","startTime","progressInterval","elapsed","progress","bar","fn","attempt","delay","lastError","retryable","path","__vitePreload","initQA","initWorkspace","initEval"],"ignoreList":[],"sources":["../utils.ts","../app.ts"],"sourcesContent":["// 공통 유틸 함수 모음\r\n\r\nconst copyTimeouts = new Map<HTMLElement, number>();\r\nconst sleep = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));\r\n\r\nexport type ToastType = \"info\" | \"success\" | \"warning\" | \"error\";\r\n\r\nexport function showToast(message: string, type: ToastType = \"info\"): void {\n    if (typeof document === \"undefined\") {\n        console.warn(`[toast:${type}] ${message}`);\n        return;\n    }\n    const toast = document.createElement(\"div\");\n    toast.className = `toast toast--${type}`;\n    toast.textContent = message;\n    document.body.appendChild(toast);\n\r\n    requestAnimationFrame(() => toast.classList.add(\"toast--show\"));\r\n    setTimeout(() => {\r\n        toast.classList.remove(\"toast--show\");\r\n        setTimeout(() => toast.remove(), 300);\r\n    }, 3000);\r\n}\r\n\r\nexport interface ApiErrorData {\n    detail?: string;\n    message?: string;\n    [key: string]: unknown;\n}\n\r\nexport class ApiError extends Error {\n    status: number;\n    canRetry: boolean;\n\n    constructor(status: number, errorData: ApiErrorData = {}) {\n        const messages: Record<number, string> = {\r\n            400: \"잘못된 요청입니다\",\r\n            401: \"인증이 필요합니다\",\r\n            403: \"접근 권한이 없습니다\",\r\n            404: \"요청한 리소스를 찾을 수 없습니다\",\r\n            429: \"요청이 너무 많습니다. 잠시 후 다시 시도해주세요\",\r\n            500: \"서버 오류가 발생했습니다\",\r\n            502: \"게이트웨이 오류입니다\",\r\n            503: \"서비스를 일시적으로 사용할 수 없습니다\",\r\n            504: \"LLM 응답 시간이 초과되었습니다. 잠시 후 다시 시도해주세요\",\r\n        };\r\n\r\n        const detail =\r\n            messages[status] ||\r\n            errorData.detail ||\r\n            errorData.message ||\r\n            \"요청 실패\";\r\n        super(detail);\r\n        this.status = status;\r\n        this.canRetry = [429, 500, 502, 503, 504].includes(status);\r\n    }\r\n}\r\n\r\nfunction handleApiError(error: unknown): void {\n    console.error(\"API Error:\", error);\n    if (error instanceof ApiError && error.canRetry) {\n        showToast(`${error.message} [다시 시도 가능]`, \"warning\");\n    } else if (error instanceof Error) {\n        showToast(error.message, \"error\");\n    } else {\n        showToast(\"알 수 없는 오류가 발생했습니다.\", \"error\");\n    }\n}\n\nexport function registerGlobalErrorHandlers(): void {\n    if (typeof window === \"undefined\") return;\n    window.addEventListener(\"error\", (event: ErrorEvent) => {\n        if (event.error) {\n            showToast(`오류: ${event.error.message}`, \"error\");\n        } else {\n            showToast(\"알 수 없는 오류가 발생했습니다.\", \"error\");\n        }\n    });\n    window.addEventListener(\"unhandledrejection\", (event: PromiseRejectionEvent) => {\n        const reason = event.reason;\n        if (reason instanceof Error) {\n            showToast(`오류: ${reason.message}`, \"error\");\n        } else if (typeof reason === \"string\") {\n            showToast(`오류: ${reason}`, \"error\");\n        } else {\n            showToast(\"알 수 없는 오류가 발생했습니다.\", \"error\");\n        }\n    });\n}\n\nexport interface ApiCallParams {\n    url: string;\n    method?: string;\n    body?: unknown;\n    signal?: AbortSignal;\n}\n\nexport async function apiCall<T = unknown>(\n    url: string,\n    method: string = \"GET\",\n    body?: unknown,\n    signal?: AbortSignal\n): Promise<T> {\n    const options: RequestInit = {\r\n        method,\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        signal,\r\n    };\r\n    if (body) {\r\n        options.body = JSON.stringify(body);\r\n    }\r\n    try {\r\n        const response = await fetch(url, options);\r\n        if (!response.ok) {\r\n            let errorData: ApiErrorData = {};\r\n            try {\r\n                errorData = await response.json();\r\n            } catch {\r\n                // ignore parse error\r\n            }\r\n            throw new ApiError(response.status, errorData);\r\n        }\r\n        return await response.json();\r\n    } catch (error: unknown) {\n        if (error instanceof DOMException && error.name === \"AbortError\") {\n            throw new Error(\"요청이 취소되었습니다\");\n        }\n        handleApiError(error);\n        throw error;\n    }\n}\n\nexport async function apiCallWithRetry<T = unknown>(\n    params: ApiCallParams & { retries?: number; initialDelayMs?: number },\n): Promise<T> {\n    const { retries = 2, initialDelayMs = 500, ...rest } = params;\n    return withRetry(\n        () => apiCall<T>(rest.url, rest.method, rest.body, rest.signal),\n        retries,\n        initialDelayMs,\n    );\n}\n\nexport function showLoading(elementId: string): void {\n    const el = document.getElementById(elementId);\n    if (!el) return;\n    el.innerHTML = '<div class=\"loading\"></div> 처리 중...';\n}\n\r\nexport function copyToClipboard(text: string, buttonEl: HTMLElement | null = null): void {\r\n    navigator.clipboard\r\n        .writeText(text)\r\n        .then(() => {\r\n            if (buttonEl) {\r\n                if (copyTimeouts.has(buttonEl)) {\r\n                    clearTimeout(copyTimeouts.get(buttonEl)!);\r\n                }\r\n                if (!buttonEl.dataset.originalText) {\r\n                    buttonEl.dataset.originalText = buttonEl.textContent || \"\";\r\n                }\r\n                buttonEl.textContent = \"✅ 복사됨\";\r\n                buttonEl.classList.add(\"copied\");\r\n                const timeout = setTimeout(() => {\r\n                    buttonEl.textContent = buttonEl.dataset.originalText || \"\";\r\n                    buttonEl.classList.remove(\"copied\");\r\n                    copyTimeouts.delete(buttonEl);\r\n                }, 1500);\r\n                copyTimeouts.set(buttonEl, timeout);\r\n            } else {\r\n                showToast(\"클립보드에 복사되었습니다!\", \"success\");\r\n            }\r\n        })\r\n        .catch((err) => showToast(\"복사 실패: \" + err.message, \"error\"));\r\n}\r\n\r\nexport interface SSEParseResult {\n    events: unknown[];\n    remainder: string;\n}\n\n// SSE 버퍼 파서 (불완전 청크 처리)\nexport function parseSSEBuffer(buffer: string): SSEParseResult {\n    const events: unknown[] = [];\n    let startIdx = 0;\r\n\r\n    while (true) {\r\n        const dataIdx = buffer.indexOf(\"data:\", startIdx);\r\n        if (dataIdx === -1) break;\r\n        const endIdx = buffer.indexOf(\"\\n\\n\", dataIdx);\r\n        if (endIdx === -1) {\r\n            return { events, remainder: buffer.slice(startIdx) };\r\n        }\r\n        const payload = buffer.slice(dataIdx + 5, endIdx).trim();\r\n        try {\r\n            events.push(JSON.parse(payload));\r\n        } catch (e) {\r\n            console.warn(\"Failed to parse SSE chunk:\", payload, e);\r\n        }\r\n        startIdx = endIdx + 2;\r\n    }\r\n    return { events, remainder: \"\" };\r\n}\r\n\r\n// 진행률 추정 헬퍼\r\nexport function showProgressWithEstimate(mode: \"batch\" | \"single\"): () => void {\r\n    const estimatedTime = mode === \"batch\" ? 90000 : 45000; // ms\r\n    const startTime = Date.now();\r\n    const progressInterval = setInterval(() => {\r\n        const elapsed = Date.now() - startTime;\r\n        const progress = Math.min(95, (elapsed / estimatedTime) * 100);\r\n        const bar = document.querySelector(\".progress-fill\") as HTMLElement;\r\n        if (bar) bar.style.width = progress + \"%\";\r\n    }, 200);\r\n    return () => clearInterval(progressInterval);\r\n}\r\n\r\nexport async function withRetry<T>(\n    fn: () => Promise<T>,\n    retries: number = 2,\n    initialDelayMs: number = 500\n): Promise<T> {\n    let attempt = 0;\r\n    let delay = initialDelayMs;\r\n    let lastError: unknown;\n    while (attempt <= retries) {\n        try {\n            return await fn();\n        } catch (err: unknown) {\n            lastError = err;\n            const retryable =\n                !err ||\n                (err instanceof ApiError && err.canRetry) ||\n                (typeof err === \"object\" &&\n                    err !== null &&\n                    \"status\" in err &&\n                    typeof (err as { status?: number }).status === \"number\" &&\n                    (err as { status: number }).status >= 500);\n            if (attempt === retries || !retryable) {\r\n                break;\r\n            }\r\n            await sleep(delay);\r\n            delay *= 2;\r\n            attempt += 1;\r\n        }\r\n    }\r\n    throw lastError;\r\n}\r\n","import { registerGlobalErrorHandlers } from \"./utils.js\";\n\n// Entry point: 페이지별 초기화\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    registerGlobalErrorHandlers();\n    const path = window.location.pathname;\n    if (path === \"/qa\") {\n        import(\"./qa.js\")\n            .then(({ initQA }) => initQA())\n            .catch((err) => console.error(\"QA 모듈 로드 실패:\", err));\n    } else if (path === \"/workspace\") {\n        import(\"./workspace.js\")\n            .then(({ initWorkspace }) => initWorkspace())\n            .catch((err) => console.error(\"Workspace 모듈 로드 실패:\", err));\n    } else if (path === \"/eval\") {\n        import(\"./eval.js\")\n            .then(({ initEval }) => initEval())\n            .catch((err) => console.error(\"Eval 모듈 로드 실패:\", err));\n    }\n});\n"],"file":"app.js"}