{"version":3,"file":"eval.js","sources":["../../eval.ts"],"sourcesContent":["import { apiCall, showToast } from \"./utils.js\";\r\nimport { loadOCR, saveOCR } from \"./ocr.js\";\r\n\r\ninterface EvalCandidate {\r\n    candidate_id: string;\r\n    score: number;\r\n    feedback: string;\r\n}\r\n\r\ninterface EvalResponse {\r\n    best: string;\r\n    results: EvalCandidate[];\r\n}\r\n\r\nexport function initEval(): void {\r\n    loadOCR();\r\n    document.getElementById(\"save-ocr-btn\")?.addEventListener(\"click\", () => saveOCR());\r\n\r\n    document.getElementById(\"eval-btn\")?.addEventListener(\"click\", async () => {\r\n        const query = (document.getElementById(\"query\") as HTMLTextAreaElement).value;\r\n        const answers = [\r\n            (document.getElementById(\"answer-a\") as HTMLTextAreaElement).value,\r\n            (document.getElementById(\"answer-b\") as HTMLTextAreaElement).value,\r\n            (document.getElementById(\"answer-c\") as HTMLTextAreaElement).value,\r\n        ];\r\n\r\n        if (!query || answers.some((a) => !a.trim())) {\r\n            showToast(\"모든 필드를 입력해주세요.\", \"error\");\r\n            return;\r\n        }\r\n\r\n        await evaluateAnswers(query, answers);\r\n    });\r\n}\r\n\r\nasync function evaluateAnswers(query: string, answers: string[]): Promise<void> {\r\n    const resultsDiv = document.getElementById(\"eval-results\");\r\n    if (!resultsDiv) return;\r\n    resultsDiv.innerHTML = \"<div class=\\\"loading\\\"></div> 처리 중...\";\r\n\r\n    try {\r\n        const data = await apiCall<EvalResponse>(\"/api/eval/external\", \"POST\", { query, answers });\r\n        resultsDiv.innerHTML = \"<h3>평가 결과</h3>\";\r\n\r\n        const table = document.createElement(\"table\");\r\n        table.innerHTML = `\r\n            <thead>\r\n                <tr>\r\n                    <th>답변</th>\r\n                    <th>점수</th>\r\n                    <th>피드백</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                ${data.results\r\n                .map(\r\n                    (r) => `\r\n                    <tr class=\"${r.candidate_id === data.best ? \"best-answer\" : \"\"}\">\r\n                        <td>${r.candidate_id} ${r.candidate_id === data.best ? \"⭐\" : \"\"}</td>\r\n                        <td>${r.score}</td>\r\n                        <td>${r.feedback}</td>\r\n                    </tr>\r\n                `,\r\n                )\r\n                .join(\"\")}\r\n            </tbody>\r\n        `;\r\n        resultsDiv.appendChild(table);\r\n    } catch (error: unknown) {\n        const message =\n            error instanceof Error ? error.message : \"알 수 없는 오류가 발생했습니다.\";\n        resultsDiv.innerHTML = `<p style=\"color: var(--danger)\">평가 실패: ${message}</p>`;\n    }\n}\n"],"names":["initEval","loadOCR","_a","saveOCR","_b","query","answers","showToast","evaluateAnswers","resultsDiv","data","apiCall","table","r","error","message"],"mappings":"yEAcO,SAASA,GAAiB,SAC7BC,EAAA,GACAC,EAAA,SAAS,eAAe,cAAc,IAAtC,MAAAA,EAAyC,iBAAiB,QAAS,IAAMC,MAEzEC,EAAA,SAAS,eAAe,UAAU,IAAlC,MAAAA,EAAqC,iBAAiB,QAAS,SAAY,CACvE,MAAMC,EAAS,SAAS,eAAe,OAAO,EAA0B,MAClEC,EAAU,CACX,SAAS,eAAe,UAAU,EAA0B,MAC5D,SAAS,eAAe,UAAU,EAA0B,MAC5D,SAAS,eAAe,UAAU,EAA0B,KAAA,EAGjE,GAAI,CAACD,GAASC,EAAQ,KAAM,GAAM,CAAC,EAAE,KAAA,CAAM,EAAG,CAC1CC,EAAU,iBAAkB,OAAO,EACnC,MACJ,CAEA,MAAMC,EAAgBH,EAAOC,CAAO,CACxC,EACJ,CAEA,eAAeE,EAAgBH,EAAeC,EAAkC,CAC5E,MAAMG,EAAa,SAAS,eAAe,cAAc,EACzD,GAAKA,EACL,CAAAA,EAAW,UAAY,sCAEvB,GAAI,CACA,MAAMC,EAAO,MAAMC,EAAsB,qBAAsB,OAAQ,CAAE,MAAAN,EAAO,QAAAC,EAAS,EACzFG,EAAW,UAAY,iBAEvB,MAAMG,EAAQ,SAAS,cAAc,OAAO,EAC5CA,EAAM,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBASRF,EAAK,QACN,IACIG,GAAM;AAAA,iCACMA,EAAE,eAAiBH,EAAK,KAAO,cAAgB,EAAE;AAAA,8BACpDG,EAAE,YAAY,IAAIA,EAAE,eAAiBH,EAAK,KAAO,IAAM,EAAE;AAAA,8BACzDG,EAAE,KAAK;AAAA,8BACPA,EAAE,QAAQ;AAAA;AAAA,iBAAA,EAIvB,KAAK,EAAE,CAAC;AAAA;AAAA,UAGjBJ,EAAW,YAAYG,CAAK,CAChC,OAASE,EAAgB,CACrB,MAAMC,EACFD,aAAiB,MAAQA,EAAM,QAAU,qBAC7CL,EAAW,UAAY,0CAA0CM,CAAO,MAC5E,EACJ"}